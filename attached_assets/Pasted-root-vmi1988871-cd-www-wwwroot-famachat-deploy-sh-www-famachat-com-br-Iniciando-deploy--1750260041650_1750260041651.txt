root@vmi1988871:~# cd /www/wwwroot/famachat && ./deploy.sh www.famachat.com.br
üöÄ Iniciando deploy do FamaChat...
[INFO] Configurando deploy para dom√≠nio: www.famachat.com.br
[INFO] Verificando pr√©-requisitos...
[INFO] Pr√©-requisitos verificados ‚úÖ
[INFO] Configurando vari√°veis de ambiente...
[INFO] Vari√°veis de ambiente configuradas ‚úÖ
[INFO] Preparando inicializa√ß√£o do banco de dados...
[INFO] Scripts de inicializa√ß√£o criados ‚úÖ
[INFO] Configurando scripts de backup...
[INFO] Scripts de backup configurados ‚úÖ
[INFO] Construindo e iniciando servi√ßos...
[INFO] Parando servi√ßos existentes...
Remover imagens antigas do Docker? (y/N): y
[INFO] Removendo imagens antigas...

[INFO] Construindo aplica√ß√£o...
postgres uses an image, skipping
redis uses an image, skipping
Building famachat
[+] Building 185.5s (20/20) FINISHED                                          docker:default
 => [internal] load build definition from Dockerfile                                    0.0s
 => => transferring dockerfile: 1.90kB                                                  0.0s
 => [internal] load metadata for docker.io/library/node:20-alpine                       0.5s
 => [internal] load .dockerignore                                                       0.1s
 => => transferring context: 1.27kB                                                     0.0s
 => CACHED [production-deps 1/4] FROM docker.io/library/node:20-alpine@sha256:d3507a21  0.0s
 => CACHED [production-deps 2/4] WORKDIR /app                                           0.0s
 => [internal] load build context                                                       0.3s
 => => transferring context: 18.35kB                                                    0.2s
 => [runtime 2/9] RUN apk update && apk upgrade &&     apk add --no-cache     dumb-ini  5.9s
 => [production-deps 3/4] COPY package*.json ./                                         0.3s
 => [builder 4/6] RUN npm ci && npm cache clean --force                                90.4s
 => [production-deps 4/4] RUN npm ci --only=production && npm cache clean --force      82.6s
 => [runtime 3/9] RUN addgroup -g 1001 -S nodejs &&     adduser -S famachat -u 1001     3.0s
 => [runtime 4/9] WORKDIR /app                                                          0.8s 
 => [builder 5/6] COPY . .                                                              0.2s 
 => [builder 6/6] RUN npm run build                                                    70.2s 
 => [runtime 5/9] COPY --from=builder --chown=famachat:nodejs /app/dist ./dist          0.1s 
 => [runtime 6/9] COPY --from=production-deps --chown=famachat:nodejs /app/node_module  7.5s 
 => [runtime 7/9] COPY --from=builder --chown=famachat:nodejs /app/package*.json ./     0.9s 
 => [runtime 8/9] COPY --from=builder --chown=famachat:nodejs /app/drizzle.config.ts .  0.3s 
 => [runtime 9/9] RUN mkdir -p /app/server/uploads &&     chown -R famachat:nodejs /ap  0.8s 
 => exporting to image                                                                 12.2s 
 => => exporting layers                                                                12.2s 
 => => writing image sha256:49355fe0e0b3e340d6fed4fe226bb65008723ba3f78e71047d12d97b29  0.0s 
 => => naming to docker.io/library/famachat_famachat                                    0.0s 
[INFO] Iniciando servi√ßos...                                                                 
WARNING: The Docker Engine you're using is running in swarm mode.

Compose does not use swarm mode to deploy services to multiple nodes in a swarm. All containers will be scheduled on the current node.

To deploy your application across the swarm, use `docker stack deploy`.

Creating network "famachat-network" with driver "bridge"
Creating volume "famachat_postgres_data" with local driver
Creating volume "famachat_redis_data" with local driver
Creating volume "famachat_uploads_data" with local driver
Creating volume "famachat_logs_data" with local driver
Creating volume "famachat_backup_data" with local driver
Pulling postgres (postgres:16-alpine)...
16-alpine: Pulling from library/postgres
Digest: sha256:ef2235fd13b6cb29728a98ee17862ff5c9b7d20515a9b34804da4a45062695f6
Status: Downloaded newer image for postgres:16-alpine
Pulling redis (redis:7-alpine)...
7-alpine: Pulling from library/redis
Digest: sha256:ee9e8748ace004102a267f7b8265dab2c618317df22507b89d16a8add7154273
Status: Downloaded newer image for redis:7-alpine
Creating famachat-redis    ... done
Creating famachat-postgres ... 
Creating famachat-postgres ... error

ERROR: for famachat-postgres  Cannot start service postgres: failed to set up container networking: driver failed programming external connectivity on endpoint famachat-postgres (449a5aed1ede022b6411ab826e83f5b05250af4cf7f5a717c386d872d7732e3f): failed to bind host port for 0.0.0.0:5432:172.20.0.3:5432/tcp: address already in use

ERROR: for postgres  Cannot start service postgres: failed to set up container networking: driver failed programming external connectivity on endpoint famachat-postgres (449a5aed1ede022b6411ab826e83f5b05250af4cf7f5a717c386d872d7732e3f): failed to bind host port for 0.0.0.0:5432:172.20.0.3:5432/tcp: address already in use
ERROR: Encountered errors while bringing up the project.
root@vmi1988871:/www/wwwroot/famachat# 
root@vmi1988871:/www/wwwroot/famachat# netstat -tulpn | grep :5432
tcp6       0      0 :::5432                 :::*                    LISTEN      1558586/dockerd     
root@vmi1988871:/www/wwwroot/famachat# docker ps | grep postgres
e8c2ef86119d   postgres:17.5                   "docker-entrypoint.s‚Ä¶"   2 days ago           Up 2 days                     5432/tcp                                   postgres_postgres.1.l6xmv7rtkm2yx010xyxxydnkc
root@vmi1988871:/www/wwwroot/famachat# 